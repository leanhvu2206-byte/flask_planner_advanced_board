{% extends "base.html" %}
{% block content %}

<style>
  /* ===== Background ƒë·ªông theo ch·ªß ƒë·ªÅ quality ===== */
  body {
    --bg1:#f7fbff; --bg2:#eef6ff; --bg3:#f5fff7;
    background:
      radial-gradient(1200px 600px at 10% -10%, var(--bg2) 0%, transparent 60%),
      radial-gradient(1000px 500px at 120% 10%, var(--bg3) 0%, transparent 60%),
      linear-gradient(120deg, var(--bg1), #ffffff);
    animation: bgMove 14s ease-in-out infinite alternate;
  }
  @keyframes bgMove {
    0% { background-position: 0 0, 0 0, 0 0; }
    100% { background-position: 10% 2%, -5% 6%, 0 0; }
  }
  /* watermark icon m·ªù (check/lab) */
  .quality-watermark{
    position: fixed; inset:auto 10px 10px auto; pointer-events:none; opacity:.08;
    font-size:84px; filter: blur(.3px);
  }

  .card{border-radius:14px; box-shadow:0 2px 10px rgba(0,0,0,.04)}
  .list-group-item{display:flex; align-items:center; gap:.5rem}
  .pill{padding:.2rem .5rem; border-radius:999px; font-size:.75rem; border:1px solid #e9ecef; background:#fff}
  .pill-date{background:#fff3cd;border-color:#ffe69c}
  .pill-status{background:#eef2ff;border-color:#dde1ff}
  .assignee-badge{background:#f8f9fa;border:1px solid #e9ecef; border-radius:999px; padding:.15rem .5rem; font-size:.75rem}
  .item-title{font-weight:600; flex:1}
  .meta-col{display:flex; align-items:center; gap:.35rem; flex-wrap:wrap}
  .section-title{font-weight:700}
  .subhead{font-size:.8rem; color:#6c757d}
</style>

<div class="quality-watermark">‚úÖüß™</div>

<h2 class="mb-3">Dashboard</h2>

<div class="row g-3">
  <!-- Boards -->
  <div class="col-lg-6">
    <div class="card">
      <div class="card-body">
        <div class="d-flex justify-content-between align-items-end">
          <div>
            <div class="section-title">Boards c·ªßa b·∫°n</div>
            <div class="subhead">Danh s√°ch board b·∫°n s·ªü h·ªØu</div>
          </div>
          <a class="btn btn-primary btn-sm" href="{{ url_for('boards_page') }}">T·∫°o / m·ªü Board</a>
        </div>
        <hr>
        <ul class="list-group list-group-flush">
          {% for b in boards %}
          <li class="list-group-item">
            <a href="{{ url_for('view_board', board_id=b.id) }}" class="item-title">{{ b.name }}</a>
          </li>
          {% else %}
          <li class="list-group-item text-muted">Ch∆∞a c√≥ board n√†o.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>

  <!-- Upcoming -->
  <div class="col-lg-6">
    <div class="card">
      <div class="card-body">
        <div class="section-title">S·∫Øp ƒë·∫øn h·∫°n</div>
        <div class="subhead mb-2">Hi·ªÉn th·ªã c√°c task c√≥ ng√†y Due g·∫ßn nh·∫•t</div>
        <div class="d-flex fw-semibold text-secondary small mb-2" style="gap:8px">
          <div class="flex-grow-1">Task</div>
          <div style="width:170px">Due / Status</div>
          <div style="min-width:220px">Assignees</div>
          <div style="width:60px"></div>
        </div>
        <ul class="list-group list-group-flush">
          {% for t in upcoming %}
          <li class="list-group-item">
            <!-- Title -->
            <div class="item-title">{{ t.title }}</div>

            <!-- Due + Status -->
            <div class="meta-col" style="width:170px">
              {% if t.due_date %}<span class="pill pill-date">{{ t.due_date }}</span>{% endif %}
              {% set stc='secondary' %}
              {% if t.status=='Done' %}{% set stc='success' %}{% elif t.status=='OverDue' %}{% set stc='danger' %}{% endif %}
              <span class="pill pill-status text-{{ stc }}">{{ t.status }}</span>
            </div>

            <!-- Assignees -->
            <div class="meta-col" style="min-width:220px">
              {% if t.assignees %}
                {% for u in t.assignees %}
                  <span class="assignee-badge" title="{{ u.email }}">{{ u.name }}</span>
                {% endfor %}
              {% else %}
                  <span class="text-muted small">‚Äî</span>
              {% endif %}
            </div>

            <!-- Link -->
            <div style="width:60px" class="text-end">
              <a href="{{ url_for('view_board', board_id=t.list.board_id) if t.list else url_for('dashboard') }}">Xem</a>
            </div>
          </li>
          {% else %}
          <li class="list-group-item text-muted">Kh√¥ng c√≥ task ƒë·∫øn h·∫°n.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
</div>

{% endblock %}
